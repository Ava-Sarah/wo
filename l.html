<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å§¥çˆ·ä¸“å±</title>
    <link rel="stylesheet" href="l.css">
</head>
<body>
<div class="container">
    <h1>å§¥çˆ·ç”Ÿæ—¥å¿«ä¹ï¼</h1>

    <!-- éŸ³ä¹æ§åˆ¶ -->
    <div class="music-control playing" id="musicControl">
        <div class="music-icon"></div>
    </div>

    <div class="volume-control" id="volumeControl">
        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1" value="0.5">
    </div>

    <!-- è·³è½¬æŒ‰é’® -->
    <button class="jump-button" id="jumpButton">
        <span class="button-icon">ğŸ‚</span>
        æŸ¥çœ‹æ›´å¤šç¥ç¦
    </button>

    <div class="scene" id="scene">
        <div class="sky" id="sky"></div>

        <!-- æ ‘å¶å’Œç¥ç¦è¯­å°†é€šè¿‡JSè‡ªåŠ¨æ·»åŠ  -->
    </div>

    <div class="footer">
        <p>çŒ®ç»™ä¸–ç•Œä¸Šæœ€æ…ˆç¥¥çš„å§¥çˆ· | ç¥æ‚¨ç¦å¦‚ä¸œæµ·ï¼Œå¯¿æ¯”å—å±±</p>
    </div>
</div>

<!-- éŸ³é¢‘å…ƒç´  -->
<audio id="bgMusic" loop>
    <!-- è¿™é‡Œå¯ä»¥æ›¿æ¢ä¸ºå®é™…çš„éŸ³ä¹æ–‡ä»¶ -->
    <source src="yesterday.mp3" type="audio/mpeg">
    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘å…ƒç´ ã€‚
</audio>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const scene = document.getElementById('scene');
        const bgMusic = document.getElementById('bgMusic');
        const musicControl = document.getElementById('musicControl');
        const volumeSlider = document.getElementById('volumeSlider');
        const volumeControl = document.getElementById('volumeControl');
        const jumpButton = document.getElementById('jumpButton');

        // ç¥ç¦è¯­æ•°ç»„ - ä¸“é—¨ä¸ºå§¥çˆ·å‡†å¤‡çš„ç”Ÿæ—¥ç¥ç¦
        const allBlessings = [
            "å§¥çˆ·ï¼Œç¥æ‚¨ç”Ÿæ—¥å¿«ä¹ï¼",
            "æ„¿æ‚¨å¥åº·é•¿å¯¿ï¼Œç¬‘å£å¸¸å¼€",
            "æ‚¨æ˜¯æˆ‘ä»¬å…¨å®¶çš„éª„å‚²",
            "æ„Ÿè°¢æ‚¨çš„æ…ˆçˆ±ä¸å…³æ€€",
            "å§¥çˆ·ï¼Œæˆ‘ä»¬æ°¸è¿œçˆ±æ‚¨ï¼",
            "æ„¿æ‚¨ç¦å¦‚ä¸œæµ·ï¼Œå¯¿æ¯”å—å±±",
            "æ‚¨çš„æ™ºæ…§æ˜¯æˆ‘ä»¬å­¦ä¹ çš„æ¦œæ ·",
            "å§¥çˆ·ï¼Œæ‚¨è¾›è‹¦äº†",
            "æ„¿æ‚¨å¤©å¤©å¼€å¿ƒï¼Œäº‹äº‹é¡ºå¿ƒ",
            "æ„Ÿè°¢æ‚¨ä¸ºå®¶åº­çš„ä»˜å‡º",
            "æ„¿æ‚¨æ°¸è¿œå¹´è½»æœ‰æ´»åŠ›",
            "æ‚¨çš„ç¬‘å®¹æ˜¯æˆ‘ä»¬æœ€å¤§çš„å¹¸ç¦",
            "å§¥çˆ·ï¼Œæ‚¨æ˜¯æˆ‘ä»¬çš„ç²¾ç¥æ”¯æŸ±",
            "ç¥æ‚¨ç¬‘å£å¸¸å¼€ï¼Œå¥åº·æ°¸é©»",
            "æ‚¨çš„å…³æ€€æ¸©æš–æˆ‘ä»¬å¿ƒæˆ¿",
            "å§¥çˆ·ï¼Œç”Ÿæ—¥å¿«ä¹ï¼Œèº«ä½“å¥åº·",
            "æ‚¨æ˜¯æˆ‘ä»¬æœ€é‡è¦çš„äºº",
            "æ„¿æ‚¨æ¯å¤©éƒ½æœ‰å¥½å¿ƒæƒ…",
            "å§¥çˆ·ï¼Œæ‚¨çš„çˆ±æ— å¯æ›¿ä»£",
            "æ„Ÿè°¢æ‚¨çš„å…»è‚²ä¹‹æ©",
            "æ„¿æ‚¨æ°¸è¿œè¢«çˆ±åŒ…å›´",
            "å§¥çˆ·ï¼Œæ‚¨æ˜¯æˆ‘ä»¬æœ€æ¸©æš–çš„ä¾é ",
            "æ‚¨çš„çˆ±æ˜¯æˆ‘ä»¬æœ€å®è´µçš„ç¤¼ç‰©",
            "æ„¿æ‚¨æ°¸è¿œå¹³å®‰å–œä¹",
            "å§¥çˆ·ï¼Œæ„Ÿè°¢æ‚¨æ•™ä¼šæˆ‘ä»¬æˆé•¿",
            "æ‚¨çš„çˆ±å¦‚é˜³å…‰èˆ¬æ¸©æš–",
            "æ„¿æ‚¨æ°¸è¿œè¢«å¹¸ç¦ç¯ç»•",
            "å§¥çˆ·ï¼Œæ‚¨æ˜¯æˆ‘ä»¬æ°¸è¿œçš„éª„å‚²",
            "æ„Ÿè°¢æ‚¨æ— å¾®ä¸è‡³çš„å…³æ€€",
            "æ„¿æ‚¨æ°¸è¿œå¥åº·å¿«ä¹"
        ];

        // å½“å‰å¯ç”¨çš„ç¥ç¦è¯­ï¼ˆå¤åˆ¶åŸå§‹æ•°ç»„ï¼‰
        let availableBlessings = [...allBlessings];
        // å­˜å‚¨å·²æ˜¾ç¤ºçš„ç¥ç¦è¯­å…ƒç´ 
        let displayedBlessings = [];

        // åˆå§‹åŒ–éŸ³ä¹
        function initMusic() {
            // è®¾ç½®åˆå§‹éŸ³é‡
            bgMusic.volume = volumeSlider.value;

            // éŸ³ä¹æ§åˆ¶ç‚¹å‡»äº‹ä»¶
            musicControl.addEventListener('click', function() {
                if (bgMusic.paused) {
                    bgMusic.play();
                    musicControl.classList.remove('paused');
                    musicControl.classList.add('playing');
                } else {
                    bgMusic.pause();
                    musicControl.classList.remove('playing');
                    musicControl.classList.add('paused');
                }
            });

            // éŸ³é‡æ§åˆ¶
            volumeSlider.addEventListener('input', function() {
                bgMusic.volume = this.value;
            });

            // è‡ªåŠ¨æ’­æ”¾éŸ³ä¹ï¼ˆéœ€è¦ç”¨æˆ·äº¤äº’ï¼‰
            document.body.addEventListener('click', function initAudio() {
                if (bgMusic.paused) {
                    bgMusic.play().catch(e => {
                        console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢:', e);
                    });
                }
                document.body.removeEventListener('click', initAudio);
            });
        }

        // åˆå§‹åŒ–è·³è½¬æŒ‰é’®
        function initJumpButton() {
            jumpButton.addEventListener('click', function() {
                // è·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢
                alert('è·³è½¬åˆ°æ›´å¤šç¥ç¦é¡µé¢');
                 window.location.href = 'x.html';
            });
        }

        // åˆ›å»ºæ ‘å¶
        function createLeaf() {
            const leaf = document.createElement('div');
            leaf.className = 'leaf';

            // å¢å¤§æ ‘å¶å°ºå¯¸
            const size = Math.random() * 40 + 40; // 40-80px
            leaf.style.width = `${size}px`;
            leaf.style.height = `${size}px`;

            // éšæœºèµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ï¼ˆå…¨å±éšæœºï¼‰
            const startX = Math.random() * (window.innerWidth + 200) - 100;
            const startY = Math.random() * (window.innerHeight + 200) - 100;
            const endX = Math.random() * (window.innerWidth + 200) - 100;
            const endY = Math.random() * (window.innerHeight + 200) - 100;

            leaf.style.setProperty('--start-x', `${startX}px`);
            leaf.style.setProperty('--start-y', `${startY}px`);
            leaf.style.setProperty('--end-x', `${endX}px`);
            leaf.style.setProperty('--end-y', `${endY}px`);

            // éšæœºå»¶è¿Ÿ
            const delay = Math.random() * 5;

            // éšæœºåŠ¨ç”»æ—¶é•¿
            const duration = Math.random() * 10 + 10;

            // è®¾ç½®åŠ¨ç”»
            leaf.style.animation = `leafFall ${duration}s linear ${delay}s forwards`;

            scene.appendChild(leaf);

            // æ ‘å¶åŠ¨ç”»ç»“æŸåç§»é™¤
            setTimeout(() => {
                if (leaf.parentNode) {
                    leaf.parentNode.removeChild(leaf);
                }
            }, (duration + delay) * 1000);
        }

        // è·å–éšæœºç¥ç¦è¯­
        function getRandomBlessing() {
            // å¦‚æœå¯ç”¨ç¥ç¦è¯­ä¸ºç©ºï¼Œé‡æ–°å¡«å……
            if (availableBlessings.length === 0) {
                availableBlessings = [...allBlessings];
            }

            // éšæœºé€‰æ‹©ä¸€ä¸ªç¥ç¦è¯­
            const randomIndex = Math.floor(Math.random() * availableBlessings.length);
            const blessingText = availableBlessings[randomIndex];

            // ä»å¯ç”¨åˆ—è¡¨ä¸­ç§»é™¤å·²é€‰ä¸­çš„ç¥ç¦è¯­
            availableBlessings.splice(randomIndex, 1);

            return blessingText;
        }

        // è·å–éšæœºä½ç½®ï¼Œé¿å…é‡å 
        function getRandomPosition() {
            let leftPos, topPos;
            let attempts = 0;
            const maxAttempts = 20;

            do {
                leftPos = Math.random() * 60 + 20; // 20% åˆ° 80%
                topPos = Math.random() * 50 + 25; // 25% åˆ° 75%
                attempts++;
            } while (isOverlapping(leftPos, topPos) && attempts < maxAttempts);

            return { leftPos, topPos };
        }

        // æ£€æŸ¥ä½ç½®æ˜¯å¦ä¸ç°æœ‰ç¥ç¦è¯­é‡å 
        function isOverlapping(leftPos, topPos) {
            for (const blessing of displayedBlessings) {
                const rect = blessing.getBoundingClientRect();
                const blessingLeft = parseFloat(blessing.style.left);
                const blessingTop = parseFloat(blessing.style.top);

                // ç®€å•è·ç¦»æ£€æŸ¥
                const distance = Math.sqrt(
                    Math.pow(leftPos - blessingLeft, 2) +
                    Math.pow(topPos - blessingTop, 2)
                );

                if (distance < 15) { // å¦‚æœè·ç¦»å°äº15%ï¼Œè®¤ä¸ºé‡å 
                    return true;
                }
            }
            return false;
        }

        // æ·»åŠ ç¥ç¦è¯­
        function addBlessing() {
            const blessingText = getRandomBlessing();
            const { leftPos, topPos } = getRandomPosition();

            const newBlessing = document.createElement('div');
            newBlessing.className = 'blessing';
            newBlessing.textContent = blessingText;

            newBlessing.style.left = `${leftPos}%`;
            newBlessing.style.top = `${topPos}%`;

            // éšæœºå»¶è¿Ÿ
            const delay = Math.random() * 2;
            newBlessing.style.animationDelay = `${delay}s`;

            scene.appendChild(newBlessing);
            displayedBlessings.push(newBlessing);

            // æ·»åŠ æ·¡å…¥æ•ˆæœ
            setTimeout(() => {
                newBlessing.classList.add('blessing-fade-in');
            }, 100);

            // ç¥ç¦è¯­ä¸å†æ¶ˆå¤±ï¼Œä¸€ç›´æ˜¾ç¤º
        }

        // åˆå§‹åŒ–åœºæ™¯
        function initScene() {
            // å¼€å§‹è‡ªåŠ¨æ·»åŠ æ ‘å¶ - æ— é™å¾ªç¯
            setInterval(() => {
                createLeaf();
            }, 800); // æ¯0.8ç§’æ·»åŠ ä¸€ä¸ªæ ‘å¶

            // å¼€å§‹è‡ªåŠ¨æ·»åŠ ç¥ç¦è¯­ - æ— é™å¾ªç¯
            setInterval(() => {
                addBlessing();
            }, 1500); // æ¯1.5ç§’æ·»åŠ ä¸€ä¸ªç¥ç¦è¯­
        }

        // åˆå§‹åŒ–
        initMusic();
        initJumpButton();
        initScene();

        // å¤„ç†å±å¹•æ—‹è½¬
        window.addEventListener('resize', function() {
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œå¯ä»¥æ·»åŠ å±å¹•æ—‹è½¬æ—¶çš„é‡æ–°å¸ƒå±€é€»è¾‘
        });
    });
</script>
</body>
</html>